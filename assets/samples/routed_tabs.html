<!DOCTYPE html>
<html>
  <head>
    <link href="stylesheets/screen.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="../downloads/active.js"></script>
    <script src="javascripts/syntax.js"></script>
    <script id="source_code">
      LayoutView = ActiveView.create(function(builder,dom){
        this.containers = {};
        var element = builder.div(
          TabView.getInstance().getElement(),
          this.containers.one = builder.div('Container One'),
          this.containers.two = builder.div('Container Two'),
          this.containers.three = builder.div('Container Three')
        );
        TabView.getInstance().observe('tab_selected',function(selected_tab_name){
          for(var container_name in this.containers){
            dom.hide(this.containers[container_name]);
          }
          dom.show(this.containers[selected_tab_name]);
        },this);
        for(var container_name in this.containers){
          dom.hide(this.containers[container_name]);
        }
        return element;
      });
      
      TabView = ActiveView.create(function(builder,dom){
        this.selectedTabName = false;
        this.tabs = {};
        var element = builder.ul(
          this.tabs.one = builder.li(builder.a({href:'#/one'},'One')),
          this.tabs.two = builder.li(builder.a({href:'#/two'},'Two')),
          this.tabs.three = builder.li(builder.a({href:'#/three'},'Three'))
        );
        return element;
      },{
        setTab: function(params){
          this.selectedTabName = params.tab;
          this.notify('tab_selected',this.selectedTabName);
        },
        getTab: function(){
          return this.selectedTabName;
        }
      });
      
      ActiveRoutes.setRoutes({
        '/:tab': [TabView,'setTab']
      });
      ActiveRoutes.observe('initialDispatchFailed',function(){
        //this serves as the default route
        TabView.getInstance().setTab({
          tab: 'one'
        });
      });

      ActiveSupport.Element.observe(document,'ready',function(){
        var example_container = document.getElementById('example_container');
        example_container.appendChild(LayoutView.getInstance().getElement());
      });
    </script>
    <script>
      ActiveSupport.Element.observe(document,'ready',function(){
        //source code highlighting setup
        var source_code_display_container = document.getElementById('source_code_display');
        var source_code = document.getElementById('source_code').innerHTML;
        source_code_display_container.innerHTML = source_code;
        dp.sh.HighlightAll('javascript',false,false,false,true,false);
      });
    </script>
  </head>
  <body>
    <a id="return" href="http://activejs.org/">Return to ActiveJS Home</a>
    <h1>Routed Tabs</h1>
    <h2><span>Uses:</span> ActiveView ActiveRoutes</h2>
    <p></p>
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr>
        <th>DOM Output</th>
        <th>Source Code</th>
      </tr>
      <tr>
        <td id="example_container"></td>
        <td><pre class="highlighted"><code class="javascript" id="source_code_display"></code></pre></td>
      </tr>
    </table> 
  </body>
</html>